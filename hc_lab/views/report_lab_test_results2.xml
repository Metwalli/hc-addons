<?xml version="1.0" encoding="utf-8"?>
<openerp>
<data>
<template id="report_lab_test_results_document1">
    <t t-call="report.external_layout">
        <div class="page">
            <h2>
                <span>Results Report</span>
            </h2>

            <div class="row mt32 mb32">
                <div class="col-xs-2" t-if="o.patient_id">
                    <strong>Patient Name:</strong>
                    <p t-field="o.patient_id"/>
                </div>
                <div class="col-xs-2" t-if="o.order_date">
                    <strong>Request Date:</strong>
                    <p t-field="o.order_date"/>
                </div>
                <div class="col-xs-2" t-if="o.doctor_id">
                    <strong>Doctor:</strong>
                    <p t-field="o.doctor_id"/>
                </div>
            </div>
             <div>
                <table class="table table-condensed">
                    <thead>
                        <tr>
                            <th></th>
                            <th>Label</th>
                            <th class="text-right">Value</th>
                            <th>       </th>
                            <th>Normal Range</th>
                        </tr>
                    </thead>
                    <t t-foreach="o.order_lines" t-as="ol">
                        <div t-if="ol.test_results">
                            <tbody>
                                <tr t-if="ol.state in ('result_entered','result_verified','dispatch')">
                                    <tr>
                                        <td><strong><span t-field="ol.name"/></strong></td>
                                    </tr>
                                    <tr t-foreach="ol.test_results" t-as="tr">
                                        <td></td>
                                        <td><span t-field="tr.label"/></td>
                                        <td class="text-right">
                                            <span t-field="tr.value"/>
                                        </td>
                                        <td><span t-field="tr.unit"/></td>
                                        <td>
                                            <t t-foreach="tr.component_id.normal_ranges" t-as="nr">
                                                <div t-if="(nr.nr_class_id.name==o.patient_id.gender)or(nr.nr_class_id.name==o.patient_id.patient_type)or(nr.nr_class_id.name=='All')">
                                                    <span t-field="nr.nr_class_id"/><span>:</span>
                                                    <span t-field="nr.low_value"/><span>-</span>
                                                    <span t-field="nr.high_value"/>
                                                </div>
                                            </t>
                                        </td>
                                    </tr>
                                </tr>
                            </tbody>
                        </div>
                    </t>
                </table>
            </div>
            <div t-if="o.order_lines.culture_results">
                <table class="table table-condensed">
                    <thead>
                        <tr>
                            <th></th>
                            <th>Antibiotic</th>
                            <th class="text-right">Value</th>
                        </tr>
                    </thead>
                    <t t-foreach="o.order_lines" t-as="ol">
                        <tbody>
                            <tr t-if="ol.state in ('result_entered','result_verified','dispatch') and ol.culture_results">
                                <tr>
                                    <td><strong><span t-field="ol.name"/></strong></td>
                                </tr>
                                <tr t-foreach="ol.culture_results" t-as="cr">
                                    <td></td>
                                    <td><span t-field="cr.name"/></td>
                                    <td class="text-right">
                                        <span t-field="cr.value"/>
                                    </td>
                                </tr>
                            </tr>
                        </tbody>
                    </t>
                </table>
            </div>
        </div>
    </t>
</template>

<template id="report_lab_test_order_results1">
    <t t-call="report.html_container">
        <t t-foreach="doc_ids" t-as="doc_id">
            <t t-raw="translate_doc(doc_id, doc_model, 'patient_id.lang', 'hc_lab.report_lab_test_results_document1')"/>
        </t>
    </t>
</template>
</data>
</openerp>
